/* ðŸ› ï¸ Set your base path */
%let base_path = \\sas-server\sftp_data;

data file_inventory;
    length path $512 fullpath $1024 filename $256 user_folder $100;
    retain path;

    /* Step 1: Start with base directory */
    path = "&base_path";
    output;
run;

/* Step 2: Loop through folders recursively */
%macro scan_folders;

    %do %while (%sysfunc(exist(work.file_inventory)));

        /* Extract first unprocessed path */
        data _null_;
            set file_inventory(obs=1);
            call symputx('current_path', path);
        run;

        /* Remove it from the list */
        data file_inventory;
            set file_inventory;
            if path ne "&current_path";
        run;

        /* Read contents of current path */
        data folder_scan;
            length path $512 fullpath $1024 filename $256 user_folder $100;
            rc = filename('mypipe', "&current_path");
            did = dopen('mypipe');

            if did > 0 then do i = 1 to dnum(did);
                filename = dread(did, i);
                fullpath = cats("&current_path\", filename);
                fid = filename('fcheck', fullpath);
                if fexist('fcheck') then do;
                    /* It's a file */
                    size = filesize(fullpath);
                    moddate = datetime();
                    user_folder = scan(fullpath, countw(fullpath, '\') - 1, '\'); /* Second last folder name as user */
                    output;
                end;
                else if dopen('fcheck') then do;
                    /* It's a subfolder â†’ queue it for next scan */
                    path = fullpath;
                    call execute('data file_inventory; set file_inventory; output; run;');
                end;
            end;
            rc = dclose(did);
        run;

        /* Append to final dataset */
        proc append base=all_files data=folder_scan force; run;

    %end;

%mend;

/* Step 3: Run the scan macro */
%scan_folders
proc sql;
    select user_folder, count(*) as num_files,
           sum(size)/1048576 as total_mb format=comma10.2
    from all_files
    group by user_folder
    order by total_mb desc;
quit;






filename listfiles pipe "dir /Q /S C:\sas\data\uploads" lrecl=32767;

data file_details;
    infile listfiles truncover;
    length line $500. owner $100. size 8. filename $200.;

    input line $char500.;

    /* Parse only file lines (not directories or header lines) */
    if index(line, ":") = 0 and index(line, "<DIR>") = 0 then do;
        /* Example line format:
           07/16/2025  02:34 PM           1,234 domain\username        filename.csv
        */
        /* Break line into pieces */
        date = scan(line, 1, ' ');
        time = scan(line, 2, ' ');
        ampm = scan(line, 3, ' ');
        size_txt = scan(line, 4, ' ');
        owner = scan(line, 5, ' ');
        do i = 6 to countw(line, ' ');
            filename = catx(' ', filename, scan(line, i, ' '));
        end;

        size = input(compress(size_txt, ','), best.);
        if not missing(owner) then output;
    end;
run;

proc sql;
    select owner, sum(size)/1024 as total_kb format=comma10.
    from file_details
    group by owner
    order by calculated total_kb desc;
quit;














filename listfiles pipe "ls -lh /sas/data/uploads" lrecl=32767;

data file_details;
    infile listfiles truncover;
    input perms $10. links $ owner $ group $ size_raw $ date1 $ date2 $ date3 $ filename $100.;
run;

proc sql;
    select owner, sum(input(size_raw, best.)) as total_size
    from file_details
    group by owner;
quit;



filename checkspace pipe "du -sh /sas/data/users/*" lrecl=32767;

data space_usage;
    infile checkspace truncover;
    input size_raw $ path $100.;
    user = scan(path, -1, '/');
run;







from openpyxl import Workbook

# Create a workbook in write-only mode
wb = Workbook(write_only=True)
ws = wb.create_sheet()

# Add some data
for i in range(1000):
    ws.append([f'This is row {i}', i])

# Save the file
wb.save('optimized_excel.xlsx')

print("Excel file created in write-only mode.")








Hi Manya,

As discussed on call, the MIDs provided are not online MIDs, and all transactions will be processed through physical POS (TID). Therefore, all TIDs should ideally cover the required expenses.

However, we noticed that some MID expenses are not covered under the respective TIDs. Could you please confirm if the below TIDs do not belong to the Palladium TID database?